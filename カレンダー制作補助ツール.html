<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>atwikiカレンダー生成</title>
    <style>
        body { font-family: 'Helvetica Neue', Arial, sans-serif; line-height: 1.6; padding: 20px; background-color: #f0f2f5; }
        .container { max-width: 800px; margin: auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h2 { color: #5c67f2; border-bottom: 2px solid #5c67f2; padding-bottom: 10px; text-align: center; }
        .input-group { margin-bottom: 20px; text-align: center; }
        label { font-weight: bold; margin-right: 10px; }
        input { padding: 10px; border: 1px solid #ddd; border-radius: 6px; width: 120px; font-size: 1.1em; text-align: center; }
        .btn-group { display: flex; gap: 10px; margin-bottom: 20px; }
        button { flex: 1; padding: 12px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 1em; }
        .gen-btn { background: #5c67f2; color: white; }
        .copy-btn { background: #34d399; color: white; }
        textarea { width: 100%; height: 450px; font-family: 'Consolas', monospace; padding: 15px; border: 1px solid #ddd; border-radius: 6px; background: #fafafa; box-sizing: border-box; resize: vertical; }
    </style>
</head>
<body>

<div class="container">
    <h2>atwikiカレンダー生成</h2>
    
    <div class="input-group">
        <label>生成する年:</label>
        <input type="number" id="year" value="2026">
    </div>

    <div class="btn-group">
        <button class="gen-btn" onclick="generateCalendar()">カレンダーを生成</button>
        <button class="copy-btn" onclick="copyToClipboard()">結果をコピー</button>
    </div>

    <textarea id="output" readonly placeholder="ここにatwiki用コードが出力されます"></textarea>
</div>

<script>
function generateCalendar() {
    const year = parseInt(document.getElementById('year').value);
    if (isNaN(year)) { alert("有効な年を入力してください"); return; }

    let result = "";

    for (let m = 0; m < 12; m++) {
        // 月ヘッダー
        result += `|>|>|>|>|>|>|BGCOLOR(#ccccff):CENTER:${m + 1}月|\n`;
        // 曜日ヘッダー
        result += `|BGCOLOR(#eeeeff):CENTER:&color(#ff0000){日}|BGCOLOR(#eeeeff):CENTER:月|BGCOLOR(#eeeeff):CENTER:火|BGCOLOR(#eeeeff):CENTER:水|BGCOLOR(#eeeeff):CENTER:木|BGCOLOR(#eeeeff):CENTER:金|BGCOLOR(#eeeeff):CENTER:&color(deepskyblue){土}|\n`;

        const firstDay = new Date(year, m, 1);
        const lastDay = new Date(year, m + 1, 0);
        let curD = 1;
        let dow = firstDay.getDay();

        // 初週の空白埋め
        let row = "|".repeat(dow + 1);

        while (curD <= lastDay.getDate()) {
            let dateText = "";
            if (dow === 0) {
                // 日曜日
                dateText = `&color(#ff0000){${curD}}`;
            } else if (dow === 6) {
                // 土曜日
                dateText = `&color(deepskyblue){${curD}}`;
            } else {
                // 平日
                dateText = `${curD}`;
            }

            row += `CENTER:${dateText}|`;

            if (dow === 6) {
                result += row + "\n";
                row = "|";
            }
            curD++;
            dow = (dow + 1) % 7;
        }

        // 最終週の空白埋め
        if (dow !== 0) {
            row += "|".repeat(7 - dow);
            result += row + "\n";
        }

        // 各月の間に空行を追加
        result += "\n";
    }

    document.getElementById('output').value = result.trim();
}

async function copyToClipboard() {
    const text = document.getElementById('output');
    if (!text.value) return;
    try {
        await navigator.clipboard.writeText(text.value);
        alert("クリップボードにコピーしました！");
    } catch (err) {
        text.select();
        document.execCommand('copy');
        alert("コピーしました！");
    }
}
</script>

</body>
</html>
